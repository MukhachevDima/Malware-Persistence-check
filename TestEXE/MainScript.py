import winreg as wr

def software():
    f = open("Software.txt", "r")
    f_arr = f.read().splitlines()
    i = 0
    for str in f_arr:
        print("_____________________")
        i = i + 1
        value = "\"C:\\labs\\TestEXE.exe\" "
        value = value + str
        try:
            registry_key = wr.OpenKey(wr.HKEY_CURRENT_USER, str, 0, wr.KEY_WRITE) #try open a key
        except:
            try:
                registry_key = wr.OpenKey(wr.HKEY_CURRENT_USER, str, 0, wr.KEY_READ) #if we can't open for write, try for read
                wr.QueryInfoKey(registry_key)
                print("don't have rights") #get info, so we don't have rights for write
                continue
            except:
                try:
                    wr.CreateKey(wr.HKEY_CURRENT_USER, str)
                except:
                    print("can't even create")
                    print(i, str)
                    continue
                registry_key = wr.OpenKey(wr.HKEY_CURRENT_USER, str, 0, wr.KEY_WRITE) #if we don't have that key, create it
                print("create key!")
        wr.SetValueEx(registry_key, "test", 0, wr.REG_SZ, value)
        wr.CloseKey(registry_key)
        print(i, str, "worked!")
        

def system():
    f = open("System.txt", "r")
    f_arr = f.read().splitlines()
    i = 0
    for str in f_arr:
        print("_____________________")
        i = i + 1
        value = "\"C:\\labs\\TestEXE.exe\" "
        value = value + str
        try:
            registry_key = wr.OpenKey(wr.HKEY_LOCAL_MACHINE, str, 0, wr.KEY_WRITE) #try open a key
        except:
            try:
                registry_key = wr.OpenKey(wr.HKEY_LOCAL_MACHINE, str, 0, wr.KEY_READ) #if we can't open for write, try for read
                wr.QueryInfoKey(registry_key)
                print("don't have rights") #get info, so we don't have rights for write
                continue
            except:
                try:
                    wr.CreateKey(wr.HKEY_LOCAL_MACHINE, str)
                except:
                    print("can't even create")
                    print(i, str)
                    continue
                registry_key = wr.OpenKey(wr.HKEY_LOCAL_MACHINE, str, 0, wr.KEY_WRITE) #if we don't have that key, create it
                print("create key!")
        wr.SetValueEx(registry_key, "test", 0, wr.REG_SZ, value)
        wr.CloseKey(registry_key)
        print(i, str, "worked!")

software()
print("___________________________")
print("SYSTEM")
print("___________________________")
system()